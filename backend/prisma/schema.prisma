generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id               String  @id @default(uuid())
  username         String  @unique @db.VarChar(20)
  email            String  @unique @db.VarChar(100)
  password         String  @db.VarChar(255)
  role             Role    @default(USER)
  balance          Int     @default(0)
  totalDeposited   Int     @default(0) @map("total_deposited")
  items            Int     @default(0)
  verify           Int     @default(0)
  emailVerifyToken String? @unique @map("email_verify_token") @db.VarChar(255)
  forgotEmailToken String? @unique @map("forgot_email_token") @db.VarChar(255)

  createdAt         DateTime          @default(now()) @map("created_at")
  updatedAt         DateTime          @updatedAt @map("updated_at")
  passwordHistories PasswordHistory[]
  gameAccounts      GameAccounts[]
  ordersService     OrdersService[]

  @@map("users")
}

model PasswordHistory {
  id        String   @id @default(uuid())
  userId    String   @map("user_id") @db.VarChar(255)
  password  String   @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  user User @relation(fields: [userId], references: [id])

  @@map("password_histories")
}

model GameCategories {
  id          String    @id @default(uuid())
  name        String    @db.VarChar(30)
  slug        String    @unique @db.VarChar(255)
  thumbnail   String    @db.VarChar(255)
  active      Int       @default(1)
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  gameGroups  GameGroups[]
  
  @@map("game_categories")
}

model GameGroups {
  id          String    @id @default(uuid())
  categoryId  String    @map("category_id") @db.VarChar(255)
  title       String    @db.VarChar(255)
  slug        String    @unique @db.VarChar(255)
  thumbnail   String    @db.VarChar(255)
  active      Int       @default(0)
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  gameAccounts  GameAccounts[]

  category GameCategories @relation(fields: [categoryId], references: [id])

  @@map("game_groups")
}

model GameAccounts {
  id          String    @id @default(uuid())
  groupId     String    @map("group_id") @db.VarChar(255)
  accountName String    @db.VarChar(255)
  password    String    @db.VarChar(255)
  price       Int
  status      Int       @default(0)
  buyerId     String?   @map("buyer_id") @db.VarChar(255)
  details     Json      
  thumb       String    @db.VarChar(255)
  images      Json     
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  group       GameGroups @relation(fields: [groupId], references: [id])
  user        User?      @relation(fields: [buyerId], references: [id])

  @@map("game_accounts")
}

model GameServices {
  id          String    @id @default(uuid())
  name        String    @db.VarChar(30)
  slug        String    @unique @db.VarChar(255)
  thumbnail   String    @db.VarChar(255)
  description String    @db.Text
  active      Int       @default(1)
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  servicePackages ServicePackages[]
  ordersService   OrdersService[]
  
  @@map("game_services")
}

model ServicePackages {
  id                   String    @id @default(uuid())
  gameServiceId        String    @db.VarChar(255)
  name                 String    @unique @db.VarChar(255)
  price                Int
  active               Int       @default(1)
  createdAt            DateTime  @default(now()) @map("created_at")
  updatedAt            DateTime  @updatedAt @map("updated_at")

  ordersService   OrdersService[]

  service   GameServices @relation(fields: [gameServiceId], references: [id])
  
  @@map("services_packages")
}

model OrdersService {
  id                    String    @id @default(uuid())
  gameServiceId         String    @map("game_service_id") @db.VarChar(255)
  servicePackageId      String    @map("service_package_id") @db.VarChar(255)
  buyerId               String    @map("buyer_id") @db.VarChar(255)
  accountName String    @db.VarChar(255)
  password    String    @db.VarChar(255)
  price                Int
  status               Int       @default(0)
  createdAt            DateTime  @default(now()) @map("created_at")
  updatedAt            DateTime  @updatedAt @map("updated_at")

  service   GameServices    @relation(fields: [gameServiceId], references: [id])
  package   ServicePackages @relation(fields: [servicePackageId], references: [id])
  user      User            @relation(fields: [buyerId], references: [id])
  
  @@map("orders_service")
}



enum Role {
  USER
  ADMIN
}
